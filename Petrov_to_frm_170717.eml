Re: update_cql3d_cswim_170101.2_update170717
From: 
petrov@compxco.com
  To: 
bobh@compxco.com
  Date: 
2017-07-17 10:44
  Attachments: 
 update_cql3d_cswim_170101.2_update17â€¦
   
Hi Bob,

This is a quick fix of the problem. Please update tdrmshst.f.

On question of why tdrmshst should be called twice - before do 120 loop
and after it (in tdinitl) -
It should be called before "call ainitial" because ainitial calls 
diaggnde,
which uses darea() array (actually, it seems it does so at n>0 only).
And it should be called after do 120 loop because
prest() array is defined in this loop (from tdtoaray call)
which is needed by tdeqdsk and then tdrmshst uses the output of tdeqdsk,
in case of partner.eq."bramb" and eqmod.eq."disabled".

Yuri




On 2017-07-17 09:32, Bob Harvey wrote:
> Hi Yuri,
> 
> I found (yesterday) that something went bad with
> total currents, going from cql3d_cswim_160323 to
> cql3d_cswim_160325.
> 
> Bob
> 
> On Monday 17 July 2017, petrov@compxco.com wrote:
>> Hi Bob,
>> 
>> Thank you.
>> I am running the latest svn version (cswim_170101.2),
>> and I see from tdoutput printout that the values of darea and dvol are
>> very bad now,
>> with negative values at the lr=4 surface.
>> Looking into it...
>> 
>> Yuri
>> 
>> On 2017-07-16 20:47, Bob Harvey wrote:
>> > Hi Yuri,
>> >
>> > Sorry, code ran to proper completion here.
>> >
>> > Attached is an earlier result, which is correct I believe.
>> >
>> > Presently, I am having problem with total current in the
>> > ZOW version.
>> >
>> > Bob
>> >
>> > On Sunday 16 July 2017, you wrote:
>> >> Hi Bob,
>> >>
>> >> Can you send me your ps file please.
>> >> I tried to run this case with my current version (capable for
>> >> multi-species runs with full-FOW(ions) + ZOW(e)),
>> >> and it crashed from bounds error.
>> >> Maybe a simple bug.
>> >> Your plots will be helpful.
>> >>
>> >> Thanks,
>> >> Yuri
>> >>
>> >> On 2017-07-16 19:39, Bob Harvey wrote:
>> >> > Hi Yuri,
>> >> >
>> >> > Could you check the attached test case with the cql3d_FOW?
>> >> > It doesn't need an eqdsk.
>> >> >
>> >> > Runs OK except the diagnostics (total current etc.) are not working.
>> >> >
>> >> > Thanks,
>> >> >
>> >> > Bob
>> >> >
>> >> >
>> >> > **********************************************************************
>> >> >*** ** Bob Harvey                                       CompX
>> >> >       phone: (858) 509-2131                        Box 2672
>> >> >       Fax:   (858) 509-2132                         Del Mar, CA 92014
>> >> >       Email: bobh@compxco.com               USA
>> >> > **********************************************************************
>> >> >*** **
>> 
update_cql3d_cswim_170101.2_update170717.zip
